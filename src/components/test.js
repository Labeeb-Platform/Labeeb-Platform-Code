
export const generateText = async () => {
	const url = "https://eu-de.ml.cloud.ibm.com/ml/v1/text/generation?version=2023-05-29";
	const headers = {
		"Accept": "application/json",
		"Content-Type": "application/json",
		"Authorization": "Bearer ApiKey-137ec15c-a931-4e1e-95c5-038e36da0292"
	};
	const body = {
		input: "<s> [INST] المطلوب: أريدك أن تقوم بتقييم القصة بناءً على المعايير التالية، وتقديم درجات لكل معيار بالإضافة إلى تعليق مختصر يوضح السبب، وأيضًا احتساب المجموع النهائي.\n\nنص القصة: ( لينة صديقةُ الأرضِ الخضراء \n في يومٍ مشمسٍ، قرَّرتْ لينةُ الصغيرةُ برفقةِ أصدقائها قضاءَ يومٍ ممتعٍ في نزهةٍ طبيعيةٍ جانبَ الحديقةِ الجميلة. وأثناءَ لعبِهم واستكشافِهم، لاحظوا القمامةَ والبلاستيك المُلقى على الأرض.\n \n\nفي يومٍ من الأيامِ، وأثناءَ لعبِ لينة وأصدقائها في الحديقةِ، وجدوا صندوقًا مليئًا بزجاجاتِ البلاستيك المهملةِ. تأثَّرَتْ لينة بهذا المنظرِ وقرَّرَتْ التصرُّفَ.\n\nاقترَحتْ لينة على أصدقائها خَيَارَيْن لِلتَّعَامُلِ معَ الموقفِ:\nالخَيَارُ الأول: جمعُ زجاجاتِ البلاستيك وإعادتِها إلى مركزِ إعادةِ التدويرِ للمساهمةِ في حمايةِ البيئة.\nالخَيَارُ  الثاني: تركُ الزجاجاتِ مكانَها والاستمرارُ في اللعبِ دون الاهتمامِ بالمشكلة.\n\nسؤال:  \nماذا ستختارُ لينة وأصدقاؤها ؟ \nالخَيَارُ الأول: جَمْعُ زجاجاتِ البلاستيك وإعادتِها إلى مركزِ إعادةِ التدويرِ للمساهمةِ في حمايةِ البيئة. \nالخَيَارُ  الثاني: تركُ الزجاجاتِ مكانَها والاستمرارُ في اللعبِ دون الاهتمامِ بالمشكلة.\n  \nفي حالِ اختيارِ لينة وأصدقائِها الخَيارَ الأولَ (جمعَ زجاجاتِ البلاستيك وإعادةِ تدويرِها)، يجدونَ أنفسَهم أمامَ موقفٍ جديد:\n أثناءَ جمْعِهِم لزُجَاجَاتِ البلاستيك، يُلاحِظُونَ وجودَ حيَوانٍ صغيرٍ مُحَاصَرٍ في إِحْدَى الزُّجَاجَاتِ.  تفكرُ لينة وأصدقاؤها: هل سيُحرِّرُونَ الحيوانَ الصغيرَ أوَّلًا، أم سيستمرونَ في جمعِ الزجاجاتِ؟ \n\nسؤال: ماذا ستختارُ لينة وأصدقاؤها في هذا الموقفِ الجديد؟ \nالخَيَارُ الأولُ: تحريرُ الحيوانِ الصغيرِ والتأكدُ منْ سلامتهِ قبلَ متابعةِ عمليةِ إعادةِ التدوير.\nالخَيَارُ الثاني: مواصلةُ جمعِ زجاجاتِ البلاستيك دونَ التوقفِ لمساعدةِ الحيوان.\n\nفي حال اختيار لينة وأصدقائها الخيار الثاني (ترك زجاجات البلاستيك مكانها والاستمرار في اللعب)، يجدون أنفسهم أمام موقف جديد:\nأثناءَ لعبِهم، يلاحظونَ أنَّ بعضَ الأطفالِ في الحديقةِ يلقونَ القمامةَ في الأرض. هل سيتوجهونَ لتوعيةِ الأطفالِ الآخرينَ أَمْ سيتجاهلونَ تصرُّفَهم ؟ \n\nسؤال: ماذا ستختارُ لينةُ وأصدقاؤها في هذا الموقفِ الجديدِ؟  الخَيَارُ الأولُ: توعيةُ الأطفالِ الآخرينَ بأهميةِ الحفاظِ على نظافةِ الحديقةِ وتشجيعهم على المساعدةِ في تنظيفِها.\nالخَيَارُ الثاني: تجاهلُ تصرُّفِ الأطفالِ الآخرينَ والاستمرارُ في اللعبِ دونَ التدخل.\n\n\n\nنهاية الخيار الأول (جمع زجاجات البلاستيك وإعادة تدويرها):\nأ\nبعدَ تحريرِ الحيوانِ الصغيرِ والتأكدِ من سلامَتِهِ، تُكْمِلُ لينةُ وأصدقاؤها جَمْعَ زجاجاتِ البلاستيك وإعادةِ تدويرها. يشعرونَ بالفخرِ لأنهم ساهموا في حمايةِ البيئةِ ومساعدةِ الحيوان.\n\nجمع زجاجات البلاستيك وعدم مساعدة الحيوان \nبعدَ أنْ تجمعَ لينةُ وأصدقاؤها الزجاجاتِ ، تبقى زجاجةٌ واحدةٌ فيها فراشةٌ صغيرةٌ محبوسةٌ، يراها عاملُ النظافةِ فيفتحُ الزجاجةَ ويُطْلِقُها .\n\nالخيار الثاني (ترك زجاجات البلاستيك مكانها والاستمرار في اللعب):\nأ. \nبعدَ تجاهلِ تصرُّفِ الأطفالِ الآخرينَ،  تزدادُ أكوامُ القمامةِ في الحديقةِ ، فتُقَرِّرُ البلديةُ إغلاقَ الحديقةِ مدَّةَ ثلاثةِ أيامٍ لتنظيفِها . تأتي لينةُ وأصدقاؤها للَّعِبِ في الحديقةِ فيجدونَها مقفلةً، ويعودونَ حزينينَ إلى بُيُوتِهم.\nب\nتُقَرِّرُ لينةُ وأصدقاؤها توعيةَ الأطفالِ الآخرينَ بأهميةِ الحفاظِ على نظافةِ الحديقةِ. يتعاونُ الجميعُ في تنظيفِ المكانِ ويتعلمونَ قيمةَ العملِ الجماعيِّ والمسؤولية.\n)\n\nالمعايير لتقييم القصة: 1- هيكل النص: تقييم مدى وضوح البداية، الوسط، والنهاية، ومدى تسلسل الأحداث. 2- الشخصيات: مدى بساطة الشخصيات وتوافقها مع البيئة الثقافية والدينية للأطفال. 3- اللغة والأسلوب: بساطة الكلمات ومدى ملاءمتها للفئة العمرية. 4- المحتوى والمغزى: وضوح المغزى الأخلاقي ومدى فهمه بسهولة. 5- الخيال والواقعية: التوازن بين الخيال المعتدل والواقعية. 6- الطول والانتباه: ملاءمة الطول للطفل وقدرته على المتابعة. 7- القيم الثقافية والدينية: تعزيز القيم الإسلامية والعربية. 8- قابلية الكلمات للتصور: إمكانية تخيل الكلمات والمواقف بسهولة. 9- قصر الجمل وكثرة الأحداث: التركيز على الجمل القصيرة والأحداث المتتابعة. 10- الملاءمة العاطفية: مناسبة المشاعر والأحداث لقدرة الطفل على الفهم.\n\nنموذج الرد المطلوب: كل معيار يحصل على درجة من 1 إلى 5، مع شرح مختصر، ثم جمع الدرجات لإعطاء المجموع النهائي.\n\n [/INST]  1. هيكل النص:\n- البداية: 4/5 - تم توضيح الفكرة الرئيسية بوضوح.\n- الوسط: 4/5 - تسلسل الأحداث منطقي ومترابط.\n- النهاية: 4/5 - تم توضيح النتائج المترتبة على الخيارات المختلفة بشكل جيد.\n   المجموع: 12/15\n\n2. الشخصيات:\n- بساطة الشخصيات: 4/5 - الشخصيات بسيطة ومناسبة لعمر الأطفال.\n- التوافق مع البيئة الثقافية والدينية: 4/5 - الشخصيات تتوافق مع القيم الإسلامية والعربية.\n   المجموع: 8/10\n\n3. اللغة والأسلوب:\n- بساطة الكلمات: 5/5 - الكلمات بسيطة ومناسبة لعمر الأطفال.\n- ملاءمة اللغة للفئة العمرية: 5/5 - اللغة ملائمة لعمر الأطفال.\n   المجموع: 10/10\n\n4. المحتوى والمغزى:\n- وضوح المغزى الأخلاقي: 4/5 - المغزى الأخلاقي واضح وسهل الفهم.\n- فهم المغزى بسهولة: 4/5 - المغزى الأخلاقي يمكن فهمه بسهولة من قبل الأطفال.\n   المجموع: 8/10\n\n5. الخيال والواقعية:\n- التوازن بين الخيال والواقعية: 4/5 - القصة توازن بين الخيال والواقعية بشكل جيد.\n   المجموع: 4/5\n\n6. الطول والانتباه:\n- ملاءمة الطول للطفل: 4/5 - طول القصة مناسب لعمر الأطفال.\n- قدرة الطفل على المتابعة: 4/5 - القصة تحافظ على انتباه الطفل.\n   المجموع: 8/10\n\n7. القيم الثقافية والدينية:\n- تعزيز القيم الإسلامية والعربية: 4/5 - القصة تعزز القيم الإسلامية والعربية بشكل جيد.\n   المجموع: 4/5\n\n8. قابلية الكلمات للتصور:\n- إمكانية تخيل الكلمات والمواقف: 5/5 - الكلمات والمواقف سهلة التخيل.\n   المجموع: 5/5\n\n9. قصر الجمل وكثرة الأحداث:\n- التركيز على الجمل القصيرة والأحداث المتتابعة: 5/5 - القصة تركز على الجمل القصيرة والأحداث المتتابعة.\n   المجموع: 5/5\n\n10. الملاءمة العاطفية:\n- مناسبة المشاعر والأحداث لقدرة الطفل على الفهم: 4/5 - المشاعر والأحداث مناسبة لقدرة الطفل على الفهم.\n   المجموع: 4/5\n\nالمجموع النهائي: 78/100\n\nتعليق مختصر: القصة جيدة من حيث الهيكل والشخصيات واللغة والمحتوى. تعزز القيم الإسلامية والعربية بشكل جيد وتحافظ على انتباه الطفل. يمكن تحسين بعض الجوانب مثل تعزيز القيم الثقافية والدينية بشكل أكبر وتوضيح المغزى الأخلاقي بشكل أكثر وضوحًا.  </s><s> [INST]",
		parameters: {
			decoding_method: "greedy",
			max_new_tokens: 900,
			min_new_tokens: 0,
			stop_sequences: [],
			repetition_penalty: 1
		},
		model_id: "sdaia/allam-1-13b-instruct",
		project_id: "3ff7f805-5517-45eb-bd59-e2b3463760b4"
	};

	const response = await fetch(url, {
		headers,
		method: "POST",
		body: JSON.stringify(body)
	});

	if (!response.ok) {
		throw new Error("Non-200 response");
	}

	return await response.json();
}